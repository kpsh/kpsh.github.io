<script lang="ts" setup>
const { gsap } = useGsap()

const paths = [
  'M67.5,141.29c-3.75,0-3.75,1.67-7.5,1.67V120H37c-.1-3.75,1.76-4.58,1.76-7.5S35.83,105,30,105s-8.75,3.75-8.75,7.5,1.67,3.75,1.67,7.5H0v60H60V157c3.75-.1,4.58,1.76,7.5,1.76S75,155.88,75,150,71.25,141.29,67.5,141.29Z',
  'M127.5,141.39c-3.75,0-3.75,1.66-7.5,1.66V120H97.06c0,3.75,1.67,3.75,1.67,7.5S95.81,135,90,135s-8.75-4.58-8.75-7.5,1.86-3.75,1.76-7.5H60v23c3.75,0,3.75-1.66,7.5-1.66s7.5,2.91,7.5,8.75-4.58,8.75-7.5,8.75S63.75,157,60,157.11V180h60V157.12c3.75-.09,4.58,1.77,7.5,1.77s7.5-2.92,7.5-8.75S131.25,141.39,127.5,141.39Z',
  'M156.88,120c-.1-3.75,1.76-4.58,1.76-7.5s-2.92-7.5-8.75-7.5-8.75,3.75-8.75,7.5,1.67,3.75,1.67,7.5H120v22.84c3.75,0,3.75-1.67,7.5-1.67s7.5,2.92,7.5,8.75-4.58,8.75-7.5,8.75-3.75-1.86-7.5-1.76V180h60V120Z',
  'M112.5,38.71c3.75,0,3.75-1.67,7.5-1.67V60h23c.1,3.75-1.76,4.58-1.76,7.5S144.17,75,150,75s8.75-3.75,8.75-7.5-1.67-3.75-1.67-7.5H180V0H120V23c-3.75.1-4.58-1.76-7.5-1.76S105,24.12,105,30,108.75,38.71,112.5,38.71Z',
  'M52.5,38.61c3.75,0,3.75-1.66,7.5-1.66V60H82.94c0-3.75-1.67-3.75-1.67-7.5S84.19,45,90,45s8.75,4.58,8.75,7.5S96.91,56.25,97,60h23V37c-3.75,0-3.75,1.66-7.5,1.66s-7.5-2.91-7.5-8.75,4.58-8.75,7.5-8.75,3.75,1.86,7.5,1.77V0H60V22.88c-3.75.09-4.58-1.77-7.5-1.77S45,24,45,29.86,48.75,38.61,52.5,38.61Z',
  'M23.13,60c.09,3.75-1.77,4.58-1.77,7.5S24.28,75,30.11,75s8.75-3.75,8.75-7.5-1.67-3.75-1.67-7.5H60V37.16c-3.75,0-3.75,1.67-7.5,1.67S45,35.91,45,30.08s4.58-8.75,7.5-8.75,3.75,1.86,7.5,1.76V0H0V60Z',
  'M67.5,81.22c-3.75,0-3.75,1.66-7.5,1.66V60H36.92c0,3.75,1.67,3.75,1.67,7.5S35.67,75,29.84,75s-8.75-4.58-8.75-7.5S23,63.75,22.85,60H0v60H22.66c0-3.75-1.66-3.75-1.66-7.5s2.91-7.5,8.75-7.5,8.75,4.58,8.75,7.5-1.86,3.75-1.77,7.5H60V97c3.75-.09,4.58,1.77,7.5,1.77S75,95.8,75,90,71.25,81.22,67.5,81.22Z',
  'M112.5,81.29c2.92,0,3.75,1.86,7.5,1.77V60H97.07c-.09-3.75,1.77-4.58,1.77-7.5S95.92,45,90.09,45s-8.75,3.75-8.75,7.5S83,56.25,83,60H60V83c3.75,0,3.75-1.67,7.5-1.67S75,84.27,75,90.1s-4.58,8.75-7.5,8.75S63.75,97,60,97.09V120H83.09c.1,3.75-1.76,4.58-1.76,7.5s2.91,7.5,8.75,7.5,8.75-3.75,8.75-7.5-1.67-3.75-1.67-7.5H120V97.13c-3.75,0-3.75,1.66-7.5,1.66S105,95.88,105,90,109.58,81.29,112.5,81.29Z',
  'M112.5,98.78c3.75,0,3.75-1.66,7.5-1.66V120h23.08c0-3.75-1.67-3.75-1.67-7.5s2.92-7.5,8.75-7.5,8.75,4.58,8.75,7.5-1.86,3.75-1.76,7.5H180V60H157.34c0,3.75,1.66,3.75,1.66,7.5s-2.91,7.5-8.75,7.5-8.75-4.58-8.75-7.5,1.86-3.75,1.77-7.5H120v23c-3.75.09-4.58-1.77-7.5-1.77S105,84.2,105,90,108.75,98.78,112.5,98.78Z',
]

onMounted(() => {
  const tl = gsap.timeline({
    repeat: -1,
    repeatDelay: 0.5,
  })

  gsap.set('.puzzle-piece', {
    scale: 0,
    opacity: 0,
    x: () => gsap.utils.random(0, 30),
    y: () => gsap.utils.random(0, 30),
    rotation: () => gsap.utils.random(0, 30),
  })

  gsap.set('.puzzle-square, .puzzle-split', {
    opacity: 0,
  })

  tl.to('.puzzle-piece', {
    scale: 0.5,
    opacity: 1,
    duration: 0.5,
    stagger: 0.1,
  })
    .to('.puzzle-piece', {
      x: 0,
      y: 0,
      rotation: 0,
      ease: 'back.out(1.2)',
      stagger: 0.1,
      duration: 1,
    })
    .to('.puzzle-piece', {
      scale: 1,
      duration: 0.5,
    })
    .to('.puzzle-square', {
      opacity: 1,
      duration: 0.5,
    })
    .to('.puzzle-piece', {
      opacity: 0,
    })
    .to('.puzzle-split', {
      opacity: 1,
    })
    .to('.puzzle-square', {
      opacity: 0,
      attr: {
        rx: 10,
      },
      duration: 0.5,
    })
    .to('.puzzle-split', {
      x: () => gsap.utils.random([-500, -180, 180, 500]),
      duration: 1,
      ease: 'back.in(1.2)',
    })
})
</script>

<template>
  <svg
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 180 180"
    width="180"
    height="180"
  >
    <path
      v-for="(path, index) in paths"
      :key="index"
      :d="path"
      class="puzzle-piece fill-primary/30 shadow-sm"
    />

    <rect
      class="puzzle-square fill-primary shadow-sm"
      x="0"
      y="0"
      width="180"
      height="180"
    />
    <g>
      <rect
        class="puzzle-split fill-primary shadow-sm"
        x="0"
        y="0"
        width="180"
        height="54"
        rx="10"
      />
      <rect
        class="puzzle-split fill-primary shadow-sm"
        x="0"
        y="63"
        width="180"
        height="54"
        rx="10"
      />
      <rect
        class="puzzle-split fill-primary shadow-sm"
        x="0"
        y="127"
        width="180"
        height="54"
        rx="10"
      />
    </g>
  </svg>
</template>
